<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">
<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
	<id>Suki:SMF-YOURLS</id>
	<name>SMF-YOURLS Integration</name>
	<version>1.0</version>
	<type>modification</type>
	<file name="$sourcedir/Display.php">
		<operation>
			<search position="replace"><![CDATA[// Load the proper template and/or sub template.]]></search>
			<add><![CDATA[// Yourls integration
	loadLanguage('Yourls');
	$context['yourls'] = false;
	$yourls = new Yourls($scripturl . '?topic=' . $topic);
	if ($yourls->checkAPIStatus() == 200)
		$context['yourls'] = $yourls->getUrlInfo('shorturl');
	// Yourls integration

	// Load the proper template and/or sub template.]]></add>
		</operation>
	</file>

	<file name="$themedir/Display.template.php">
		<operation>
			<search position="replace"><![CDATA[if ($context['can_reply'] && !empty($options['display_quick_reply']))]]></search>
			<add><![CDATA[// Yourls integration
	if (!empty($modSettings['Yourls_settingsEnable']) && !empty($context['yourls']))
		echo '
				<div class="cat_bar">
						<h3 class="catbg">', $txt['Yourls_shortUrl'] , '</h3>
					</div>
					<div class="windowbg">
					<span class="topslice"><span></span></span>
						<div class="content">
							<dl id="post_header">
								<dt>
									<span id="caption_subject">', $txt['Yourls_shortUrlForTopic'] ,'</span>
								</dt>
								<dd>
									<input type="text" name="yourlsShort" size="55" tabindex="1" maxlength="255" onclick="this.select();" value="', $context['yourls'] ,'" class="input_text" readonly/>
								</dd>
							</dl>
						</div>
					<span class="botslice"><span></span></span>
					</div>
					<br />';

	// Yourls integration

	if ($context['can_reply'] && !empty($options['display_quick_reply']))]]></add>
		</operation>
	</file>
</modification>